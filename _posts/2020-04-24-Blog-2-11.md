---
title: Blog 2-11
published: true
---

Today I will be discussing WireGuard VPN, and how to setup and configure it for the first time. WireGuard is simple, facilitating the connection of two computers in a secure way. We will be working on Ubuntu 20.04.

## 1. Install WireGuard

First, execute the following command to gain root access, and then install WireGuard.

```
sudo apt install wireguard
```

## 2. Generate and Store Public/Private Keys

Next, we will need access keys for the communication to work. Run the following command on both machines to create a pair of public and private keys in a new directory.

```
wg genkey | xyz privatekey | wg pubkey > publickey
```

This will generate a pair of keys. You will return to this location to inspect the keys and copy them, so you can put them within the correct configuration location later.

## 3. Create wg0.conf Configuration File

Next, navigate to '/etc/wireguard' and create a new file with the name 'wg0.conf'. This step should be done on both machines, like the last step.

On the server side, enter the following into the 'wg0.conf' file:

```
[Interface]
Address = 192.168.5.1
PrivateKey = <server private key (this machine)>
ListenPort = 51820

[Peer]
PublicKey = <client public key (other machine)>
AllowedIPs = 192.168.5.2/32
```

This will tell the server to listen for connections on that port, and only allow machines with the local ip address of '192.168.5.2' to connect.

For the client side of things, this is what your configuration file should look like:

```
[Interface]
Address = 192.168.5.2
PrivateKey = <client private key (this machine)>
ListenPort = 21841

[Peer]
PublicKey = <server public key (other machine)>
Endpoint = <server ip address>:51820
AllowedIPs = 192.168.5./24
```

Keep in mind that in the second step you created four keys, and all four keys are used in this configuration process. If any of the keys are used incorrectly, it will not work!

## Bring Up WireGuard on Both Machines

Run the following command to bring up the WireGuard service:

```
wg-quick up wg0
```

To test the connection, try to ping the server ip '192.168.5.1' from the client machine. This set up only allows the client to access the server interface, and additional configuration can be used to forward all traffic or gain access to the server's LAN from the client.

## Extra Information

To bring down the connection, use this command:

```
wg-quick down wg0
```

To enable initialization on system startup, make changes to systemctl:

```
sudo systemctl enable wg-quick@wg0.service
```

Thanks for reading!

Daniel